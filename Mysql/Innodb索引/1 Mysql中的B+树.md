# Mysql中的B+树

## B+树结构

* B树是多叉平衡搜索树
* 每个节点内有多个元素, 每个子节点的元素值域范围对应父节点两个元素的间隙
* B+树的非叶子节点仅为目录, 数据都在叶子节点

## Mysql索引中的B+树

* B+树不要求叶子节点之间有链表, 但一般实现都会加链表, Mysql也通过Innodb页的next和prev指针实现了双向链表
* Mysql一页一般为16KB, 可以存储的数据条数大, 可以使得B+树扁平化(矮胖), 降低B+树的度数, 从而降低在索引检索过程中可能的磁盘IO次数

## Mysql为什么不使用其他数据结构?

### Hash

* 不满足范围查询功能
* Hash索引存储到磁盘之后也要设法检索

### 二叉树系列

* 二叉树一个节点只能存放等值的数据, 指向比它小的数据, 比他大的数据, 大部分情况下页的利用率低, 而且层数高
* 平衡二叉树, 红黑树的维护成本还高, 经常需要旋转等情况

### 为什么不用B树

* B树的数据可以存放在中间层节点上, 对于Mysql的聚簇索引来说就是把行放在了中间层 会带来以下问题
  * 一页能存放的目录条数大大减少, 使得树的度数增加
  * 数据节点之间的指针维护麻烦

