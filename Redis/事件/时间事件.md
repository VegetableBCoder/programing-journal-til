# 时间事件

## 分类

* 定时事件: 指定时间之后执行一次 函数调用之后返回AE_NOMORE
* 周期性事件: 每隔一段时间执行一次 调用之后返回一个非AE_NOMORE的值, 表示事件的下次运行事件间隔

## 属性

* id: 全局id, 新的事件必定比旧的id更大
* when: 记录事件的到达时间 
* tieProc
  * 时间事件处理器

## 实现

* 将所有时间事件放在一个无序链表中
* 当时间事件执行器运行时, 遍历整个链表, 查找所有已经到达的事件, 调用相应的处理器

## 常见的serverCron任务

* 更新统计信息: 如内存占用, 数据库占用情况
* 清理数据库中的过期键值对
* 关闭/清理连接失效的客户端
* 尝试进行AOF/RDB持久化
* 如果是主服务器, 需要对从节点进行定期同步
* 如果处于集群模式, 需要对集群进行定期同步和连接测试

